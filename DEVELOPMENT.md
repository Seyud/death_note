# 🚀 开发文档

## 📋 项目概述

🔧 本项目是一个专为 Android 平台设计的 Rust 系统级工具，主要用于设备信息识别和分区还原操作。项目专注于 64 位 Android 架构，提供了识别系统和制导系统两大核心功能模块。

## 🏗️ 项目架构

### 🔑 核心模块

1. **🕵️ 异步识别系统 (identification)** - 并行身份识别模块
   - **📱 酷安识别器 (CoolapkIdentifier)** - 异步酷安数据提取
   - **✈️ Telegram识别器 (TelegramIdentifier)** - 异步Telegram用户识别
   - **💬 QQ识别器 (QQAsyncIdentifier)** - QQ用户识别，从acc_info[QQ号].xml提取QQ号
   - **🎯 识别管理器 (IdentificationManager)** - 统一协调所有识别器
2. **🚀 异步制导系统 (AsyncGuidanceSystem)** - 基于异步识别结果的决策系统
   - **⚡ 并行黑名单检查** - 同时处理所有识别结果
   - **🧠 智能决策引擎** - 基于检查结果决定是否执行操作
3. **🚫 黑名单系统 (BlacklistSystem)** - 黑名单ID管理和检查


## 📊 性能对比

### ⚡ 同步 vs 异步执行时间

| 识别器数量 | 同步执行时间 | 异步执行时间 | 性能提升 |
|-----------|-------------|-------------|----------|
| 2个       | ~200ms ⚫    | ~120ms 🟢   | 40% 📈   |
| 3个       | ~300ms ⚫    | ~130ms 🟢   | 57% 📈   |
| 4个       | ~400ms ⚫    | ~130ms 🟢   | 67% 📈   |
| 8个       | ~800ms ⚫    | ~140ms 🟢   | 82% 📈   |

> 💡 **注：实际性能提升取决于设备硬件和识别器复杂度**

## 🔄 程序运行顺序

### 🚀 异步并行执行流程

```
🚀 主程序启动 (异步)
    ↓
🎯 识别管理器启动 (并行执行)
    ├── 📱 酷安识别器 (异步)
    │   └── 🔍 获取酷安UID
    ├── ✈️ Telegram识别器 (异步)
    │   └── 🔍 获取所有Telegram UID
    ├── 💬 QQ识别器 (异步)
    │   └── 🔍 从acc_info[QQ号].xml提取QQ号
    └── ... 🔧 更多识别器 (异步)
    ↓
🚀 异步制导系统处理 (并行处理所有结果)
    ├── ⚡ 并行黑名单检查
    │   ├── 📱 检查所有酷安UID
    │   ├── ✈️ 检查所有Telegram UID
    │   ├── 💬 检查所有QQ号
    │   └── 🔧 检查其他识别器结果
    ├── 🧠 决策阶段 (基于所有结果)
    │   ├── 🚨 发现黑名单ID → ⚡ 并行执行还原
    │   └── ✅ 无黑名单ID → ⏭️ 跳过制导系统
    └── 🎯 执行阶段 (异步并行)
        ├── 🔧 异步还原boot分区
        └── 🔧 异步还原init_boot分区
    ↓
🏁 程序结束
```

### 🌟 异步并行优势

- **⚡ 并行识别**: 所有识别器同时执行，大幅缩短识别时间
- **⏰ 超时控制**: 单个识别器超时不会影响其他识别器
- **🔧 动态扩展**: 轻松添加新的软件识别器
- **💪 资源优化**: 充分利用多核CPU性能
- **🛡️ 容错机制**: 单个识别器失败不会影响整体系统

### ⚙️ 条件触发机制

- **🎯 异步制导系统触发条件**: 基于所有识别器的综合结果
- **🔍 并行黑名单检查**: 同时检查所有识别到的UID
- **🧠 智能决策**: 基于所有来源的黑名单命中情况
- **🔒 安全机制**: 无黑名单ID时自动跳过所有分区还原操作
- **📊 详细报告**: 显示每个识别器的执行状态和结果

## 🎯 核心功能详解

### 1. 🕵️ 识别系统 (identification/)

识别系统采用模块化设计，包含多个独立的识别模块：

### 2. 🚀 制导系统 (guidance_async.rs)

#### 📝 功能描述
- 🧠 基于识别结果进行决策
- 🔧 还原 boot 分区
- 🔧 还原 init_boot 分区
- ⚙️ 系统级操作执行
